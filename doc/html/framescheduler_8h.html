<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>framescheduler.h File Reference</title>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="DoxyStyle.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;" nowrap="nowrap">
   <div id="projectname"><a href="http://blacktoppstudios.com"><img src="logogreen100pxtall.png"></a>MezzanineEngine&#160;<span id="projectnumber">November 2012</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_b971682af87995f4dd389d6012b1b8c2.html">src</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a> &#124;
<a href="#define-members">Defines</a>  </div>
  <div class="headertitle">
<div class="title">framescheduler.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file has the Declarations for the main FrameScheduler class.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="datatypes_8h_source.html">datatypes.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="thread_8h_source.html">thread.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="doublebufferedresource_8h_source.html">doublebufferedresource.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="workunitkey_8h_source.html">workunitkey.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="systemcalls_8h_source.html">systemcalls.h</a>&quot;</code><br/>
<code>#include &lt;map&gt;</code><br/>
<code>#include &lt;set&gt;</code><br/>
<code>#include &lt;fstream&gt;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for framescheduler.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="framescheduler_8h__incl.svg" width="100%" height="372"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="framescheduler_8h__dep__incl.svg" width="100%" height="252"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div>
<p><a href="framescheduler_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMezzanine_1_1Threading_1_1FrameScheduler.html">Mezzanine::Threading::FrameScheduler</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This is central object in this algorithm, it is responsible for spawning threads and managing the order that work units are executed.  <a href="classMezzanine_1_1Threading_1_1FrameScheduler.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceMezzanine.html">Mezzanine</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><p>All of the <a class="el" href="namespaceMezzanine.html" title="All of the Mezzanine game library components reside in this namespace.">Mezzanine</a> game library components reside in this namespace. </p>
<br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceMezzanine_1_1Threading.html">Mezzanine::Threading</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><p>This is where game specific threading algorithms and a minimalistic subset of the std threading library a held. </p>
<br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="framescheduler_8h.html#a4f3c350ff3b5c50a8dabcea7aadf05d3">TimingCostAllowanceGap</a>&#160;&#160;&#160;10</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a configuration settings to tune the precision of timing at compile time.  <a href="#a4f3c350ff3b5c50a8dabcea7aadf05d3"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This file has the Declarations for the main FrameScheduler class. </p>

<p>Definition in file <a class="el" href="framescheduler_8h_source.html">framescheduler.h</a>.</p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="a4f3c350ff3b5c50a8dabcea7aadf05d3"></a><!-- doxytag: member="framescheduler.h::TimingCostAllowanceGap" ref="a4f3c350ff3b5c50a8dabcea7aadf05d3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="framescheduler_8h.html#a4f3c350ff3b5c50a8dabcea7aadf05d3">TimingCostAllowanceGap</a>&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This is a configuration settings to tune the precision of timing at compile time. </p>
<p>Each frame that is executed has a desired length of time as determined by the Desired Frame Rate that can set using <a class="el" href="classMezzanine_1_1Threading_1_1FrameScheduler.html#a4f018d5cd5f64a25dddd274068177add">FrameScheduler::SetFrameRate()</a> or <a class="el" href="classMezzanine_1_1Threading_1_1FrameScheduler.html#a60fbfa1fdd301cf931dd01b9474d2ec8">FrameScheduler::SetFrameLength()</a>. If execution of a frame finishes before it has consumed its portion of a second, then work is paused the desired length has elapsed. This means that if there is too much work each frame that the frame rate will suffer. <br/>
 <br/>
 The timing of frame lengths with this algorithm is not perfect. Each frame ends a certain amount of microseconds early or late. This inaccuracy can be introduced by the system's timer resolution, the time it takes to lookup the time, or by the work that must be done outside of the of the timed work or pause periods to aggregate data. On Ubuntu 12.04 x64 has a simple timer with a single microsecond resolution, this algorithm tends to drift less than 2 microseconds per frame. Some other algorithms are more precise, and others are simpler, this is a balance between those. If this is not acceptable <a class="el" href="namespaceMezzanine.html#ab6d717bb285a5e718d7f9946071d4849">GetTimeStamp()</a> and <a class="el" href="classMezzanine_1_1Threading_1_1FrameScheduler.html#ac59d45091a7758912f9e7c7871c7c5d9">FrameScheduler::WaitUntilNextThread()</a> could be modified to adjust this. <br/>
 <br/>
 The pause that is inserted each frame is not simply calculated by subtracting the current time from the target time once the work is done each frame. A small <a class="el" href="classMezzanine_1_1Threading_1_1FrameScheduler.html#a6aab80a2e99f134f12e4aab16dd33b4f">TimingCostAllowance</a> is subtracted from the pause before the next frame begins. This allowance allows for the compensation of variances in scheduling from the underlying system, rounding errors of the system clock and the execution of the time tracking itself. As part of this time tracking the timing cost allowance is adjusted. If the allowance was too large, therefor making the frame too short, then it is made longer for the next frame. If the allowance is too small it is made larger for the next frame. It does seem possible to track this length within a single frame without increasing the complexity a significant amount. <br/>
 <br/>
 Rather than increase the complexity of the algorithm when the default level of accuracy is suitable for most purposes, a manual compile time adjustment has been added. When comparing the length of the frame after execution and frame pause have occurred, the timing allowance is made smaller or larger based on how close the result is to the desired time. If the frame was not exactly as fast as it should have been, then the allowance is adjusted. Frames tend to take slightly longer than the target length. To compensate for this if the frame executed faster by a predefined amount or less then the timing allowance is not adjusted. This gap in the adjustment of the timing allowance could allow adjustment on different platforms in the precision of this algorithm without incurring extra complexity in timing. By default this is set to 10 microseconds. <a class="el" href="classMezzanine_1_1Threading_1_1FrameScheduler.html#a7af749e5eb3f5d53cc9b3fc122a03af6">FrameScheduler::GetFrameLength()</a> </p>

<p>Definition at line <a class="el" href="framescheduler_8h_source.html#l00101">101</a> of file <a class="el" href="framescheduler_8h_source.html">framescheduler.h</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>
Generated on Sat Nov 24 2012 21:23:43 for DagFrameScheduler by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1</small></address>
</body>
</html>
